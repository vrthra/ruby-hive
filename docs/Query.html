<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" rel="stylesheet" href="hive.css" >
    <title>hive</title>
</head>
<body>
    <p class="head">
<table valign='top'><tr><td><a href="/ruby-hive/Hive.html"><img src="hive.png" alt="hive" width='50' height='50' border='0' /></a></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><a href="http://github.com/vrthra/ruby-hive/">Code</a> |<a href="FrontPage.html">FrontPage</a> |<a href="HiveTraits.html">HiveTraits</a> </td><tr></table><br/>
    </p>
    <p class="content">
<a href="Query.html">Query</a><br/><br/><br/><h2>Using Query</h2><br/>The query service (integrated with hivehome server as queen) provides a convenient abstraction over the cluster. It provides an SQL like view over the information returned by individual invocations. <br/><br/>column = trait invocations<br/>row = machines <br/>table = channels <br/><br/><h2> Screen Shot</h2><br/>A simple query being run.<br/><br/><img src="query.png" alt="query"&nbsp;&nbsp; border='0' /><br/><br/><h2>select </h2><br/><h3> <a href="SelectFunctions.html">SelectFunctions</a></h3><br/>&nbsp;&nbsp; :sum :product :expr :and :or :uniq<br/><br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!select :uniq(<a href="my.html">$my:</a>nick) from #hive where <a href="sys.html">$sys:</a>version <> 0.2<br/>&nbsp;&nbsp;!select [:sum(<a href="sys.html">$sys:</a>version) * :sum(<a href="sys.html">$sys:</a>version)] :sum(<a href="sys.html">$sys:</a>version) from #hive where <a href="my.html">$my:</a>session[os] =~ /sparc/i<br/>&nbsp;&nbsp;!select <a href="sys.html">$sys:</a>hostname from #hive where <a href="my.html">$my:</a>session[os] =~ /win/i<br/>&nbsp;&nbsp;!select <a href="file.html">$file:</a>rm[/tmp/mexico] from #hive<br/><br/><b>&nbsp;&nbsp;any ruby statement</b><br/>&nbsp;&nbsp;!select <a href="ruby.html">$ruby:</a>eval[1 + 2] from #hive<br/>&nbsp;&nbsp;!select {1 + 2} from #hive<br/><br/>&nbsp;&nbsp;!select :sum(<a href="sys.html">$sys:</a>echo[1]) from #run_tests<br/>&nbsp;&nbsp;!select :product(<a href="sys.html">$sys:</a>version) from #run_tests<br/>&nbsp;&nbsp;!select [:product(<a href="sys.html">$sys:</a>version) + :product(<a href="sys.html">$sys:</a>echo[2])] from #run_tests<br/>&nbsp;&nbsp;!select <a href="ruby.html">$ruby:</a>eval[<a href="sys.html">$sys:</a>version * 2]&nbsp;&nbsp;from #hive<br/>&nbsp;&nbsp;!select [:sum(<a href="ruby.html">$ruby:</a>eval[<a href="sys.html">$sys:</a>version * (2+3)]) * 6]&nbsp;&nbsp;from #hive<br/>&nbsp;&nbsp;!select <a href="me.html">$me:</a>tag[me] from #hive where <a href="my.html">$my:</a>session[os] !~ /sparc/<br/>&nbsp;&nbsp;!select :sum(<a href="sys.html">$sys:</a>version) from #hive group by <a href="me.html">$me:</a>tag<br/>&nbsp;&nbsp;!select {<a href="me.html">$me:</a>session[os][-3..-1]}, {2+4} :sum(<a href="sys.html">$sys:</a>version) from #hive group by {<a href="sys.html">$sys:</a>session[os][-3..-1]}<br/></td></tr></table><br/>The braces provide a way to escape into executable expressions from the do string. <br/><br/>the :sum, :product etc are collectors that collect data from multiple machines. <br/><br/><h2> ScreenShot</h2> of a query using select functions.<br/><br/><img src="complex-query.png" alt="query"&nbsp;&nbsp; border='0' /><br/><br/>defining new collectors. <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>#any unix command line. <br/>&nbsp;&nbsp;!select <a href="sys.html">$sys:</a>cat[/tmp/out]&nbsp;&nbsp;from #hive<br/>&nbsp;&nbsp;!select <a href="sys.html">$sys:</a>ls[/tmp | wc -l ] from #hive where <a href="me.html">$me:</a>session[host] =~ /vaishnavam/<br/>&nbsp;&nbsp;!select <a href="sys.html">$sys:</a>ls[/tmp | head -2 ] from #hive where <a href="me.html">$me:</a>session[host] =~ /vaishnavam/<br/>&nbsp;&nbsp;!select <a href="env.html">$env:</a>HOME from #hive<br/>&nbsp;&nbsp;!select <a href="env.html">$env:</a>PATH[/bin:/sbin] from #hive<br/>&nbsp;&nbsp;!select <a href="sys.html">$sys:</a>ps[-eaf | grep ruby | awk '\{print $0 $2\}' ] from #hive<br/></td></tr></table><br/><h3>insert </h3><br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!insert into #sunos from #hive,#mexico<br/>&nbsp;&nbsp;!insert into #sunos from #hive where <a href="me.html">$me:</a>session[os] =~ /sparc/i<br/>&nbsp;&nbsp;!insert into #win32 from #hive where <a href="me.html">$me:</a>session[os]=~ /nt/<br/></td></tr></table><br/><h3>delete </h3><br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!delete from #sunos where <a href="me.html">$me:</a>session[os] !~ /sparc/i<br/>&nbsp;&nbsp;!delete from #sunos<br/></td></tr></table><br/><h3>update </h3><br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!update #hive with all where <a href="sys.html">$sys:</a>os =~ /WINNT/i<br/></td></tr></table>
    </p>
</body>
</html>
