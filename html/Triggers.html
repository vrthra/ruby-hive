<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" rel="stylesheet" href="hive.css" >
    <title>hive</title>
</head>
<body>
    <p class="head">
<table valign='top'><tr><td><a href="/Hive.html"><img src="hive.png" alt="hive" width='50' height='50' border='0' /></a></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><a href="http://code.google.com/p/ruby-hive/">Code</a> |<a href="FrontPage.html">FrontPage</a> |<a href="HiveTraits.html">HiveTraits</a> </td><tr></table><br/>
    </p>
    <p class="content">
<a href="Triggers.html">Triggers</a><br/><h2>Actions that can cause a trigger</h2>join<br/>part<br/>privmsg<br/><br/><h1>Creating Triggers</h1><h2>Inline Triggers</h2><br/>Inline triggers are simple to create. They come in two major forms: <br/><ol><li>A single command send to the machine that invokes the trigger</li>&nbsp;&nbsp;!create trigger mytr for join use !do <a href="sys.html">$sys:</a>rdate[hivehome] <br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/><br/>Here, the command !do <a href="sys.html">$sys:</a>rdate[hivehome] is sent to the machine that joins the current channel. <br/><br/><li>A ruby block getting invoked in response to a triggered event</li>&nbsp;&nbsp;!create trigger mytr for join use {|machine,args|tell(machine,'welcome') if machine !/^_/} <br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>Here, the ruby block gets executed with args machine,args. <br/></ol><br/><h2>Persistant Triggers</h2><br/>Persistant triggers are those that are included directly in triggers.rb. An example below <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>trigger :mytrig do |channel, machine, action, args|<br/>&nbsp;&nbsp;&nbsp;&nbsp;case action <br/>&nbsp;&nbsp;&nbsp;&nbsp;when /join/ <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say '!do <a href="system.html">$system:</a>version', machine do |reply|<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply "got reply #{reply}" <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply "channel:#{channel} machine:#{machine} action:#{action} args:#{args}" <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br/>&nbsp;&nbsp;&nbsp;&nbsp; when /part/ <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply "#{machine} leaving #{channel}" <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply "channel:#{channel} machine:#{machine} action:#{action} args:#{args}" <br/>&nbsp;&nbsp;&nbsp;&nbsp;end <br/>&nbsp;&nbsp;&nbsp;&nbsp;end <br/>end <br/></td></tr></table><br/>This is made use of below. <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger mytr for join use mytrig <br/></td></tr></table><br/>These triggers are also allowed to take an argument which will be available in @initargs inside the MyTrigger. <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>trigger :myargtrig do |channel, machine, action, args|<br/>&nbsp;&nbsp;&nbsp;&nbsp;@me.reply "Created with args #{@initargs}" <br/>end <br/></td></tr></table><br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger mytr for join use myargtrig(Created with this arg) <br/></td></tr></table><br/><br/><h1>Using Triggers</h1><br/><h2>Creating</h2>General example: <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger dummyt on #hive for join use dummytrig <br/></td></tr></table><br/>Do it on default channel (no channel specified) <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger dummyt for join use dummytrig <br/></td></tr></table><br/>Do it with args <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger dummyt for join use dummytrig(myargs) <br/></td></tr></table><br/>Use Inline <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger mytr for join use !do <a href="sys.html">$sys:</a>rdate[hivehome] <br/></td></tr></table><br/>Use Inline second version <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!create trigger newtrig on #hive for part use {|machine,args| @me.send_message machine, '!do <a href="sys.html">$sys:</a>rdate[webproxy]'} <br/></td></tr></table><br/><h2>Dropping</h2>General: <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!drop trigger dummytrig on #hive <br/></td></tr></table><br/>On current channel. <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!drop trigger dummytrig <br/></td></tr></table><br/><h2>Listing</h2>List all triggers on channel <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!triggers on #hive <br/></td></tr></table><br/>Assume channel <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!triggers <br/></td></tr></table><br/>Triggers for action 'join' <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!triggers on #hive for join <br/></td></tr></table><br/>Triggers that use a particular procedure <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!triggers on #hive using dummytrig <br/></td></tr></table><br/>Triggers that use a particular procedure and for a particular action <br/><table class='code' style='border-spacing: 10px;width:100%' ><tr><td class='code'>&nbsp;&nbsp;!triggers on #hive for join using dummytrig <br/></td></tr></table>
    </p>
</body>
</html>
